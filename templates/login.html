{% extends "base.html" %}
{% block title %}Iniciar Sesi칩n{% endblock %}

{% block content %}
<section class="auth-section">
  <div class="card">
    <div class="card-body">
      <h2 class="card-title">游댐 Iniciar Sesi칩n</h2>

  <form action="/login" method="post">
    <input type="hidden" name="csrf_token" value="{{ request.session.get('csrf') }}">          <label for="username">Usuario:</label>
          <input type="text" id="username" name="username" placeholder="Ingresa tu usuario" required>
        </div>

        <div class="form-group password-wrapper">
  <label for="password">Contrase침a:</label>
  <input type="password" id="password" name="password" class="password-input" placeholder="Ingresa tu contrase침a" required>
<button type="button" class="toggle-password" aria-label="Mostrar u ocultar contrase침a">
  <svg class="icon-eye" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
    <path d="M12 4.5C7 4.5 2.73 8.11 1 12c1.73 3.89 6 7.5 11 7.5s9.27-3.61 11-7.5c-1.73-3.89-6-7.5-11-7.5zm0 12a4.5 4.5 0 1 1 0-9 4.5 4.5 0 0 1 0 9zm0-1.5a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
  </svg>
</button>
</div>


        <button type="submit" class="btn btn-primary">Entrar</button>
      </form>

      <a href="/register" class="register-link">쯅o tienes cuenta? Reg칤strate aqu칤.</a>
      <a href="/recuperar" class="register-link">쯆lvidaste tu contrase침a?</a>

    </div>
  </div>
</section>
{% endblock %}

{% block scripts %}
  {% if request.session.get("error") %}
    <script>
      window.addEventListener("DOMContentLoaded", function () {
        const toastBody = document.getElementById("toast-body");
        const toast = document.getElementById("toast-alert");

        toastBody.innerText = "{{ request.session.get('error') }}";
        toast.classList.add("show");

        document.getElementById("toast-close-btn").onclick = function () {
          toast.classList.remove("show");
          fetch("/clear_error", { method: "POST" });
        };
      });
    </script>
  {% endif %}

 <script>
  document.addEventListener("DOMContentLoaded", function () {
    document.querySelectorAll(".toggle-password").forEach((btn) => {
      btn.addEventListener("click", function () {
        const input = this.closest(".password-wrapper").querySelector(".password-input");
        const isHidden = input.type === "password";
        input.type = isHidden ? "text" : "password";

        // Actualizar el 칤cono
        this.innerHTML = isHidden
          ? `<svg class="icon-eye-off" xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
               <path d="M12 6a9.77 9.77 0 0 1 8.94 6 9.77 9.77 0 0 1-8.94 6 9.77 9.77 0 0 1-8.94-6A9.77 9.77 0 0 1 12 6zm0-1.5C6.58 4.5 2.05 8.28.38 12c1.67 3.72 6.2 7.5 11.62 7.5s9.95-3.78 11.62-7.5C21.95 8.28 17.42 4.5 12 4.5zm0 6.75a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3z"/>
             </svg>`
          : `<svg class="icon-eye" xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
               <path d="M12 4.5C7 4.5 2.73 8.11 1 12c1.73 3.89 6 7.5 11 7.5s9.27-3.61 11-7.5c-1.73-3.89-6-7.5-11-7.5zm0 12a4.5 4.5 0 1 1 0-9 4.5 4.5 0 0 1 0 9zm0-1.5a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
             </svg>`;
      });
    });
  });
</script>

{% endblock %}